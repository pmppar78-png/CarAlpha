---
layout: layouts/base.njk
ogType: "article"
---

{# ── Guide Layout — extends base with TOC, author info, related guides, CTAs ── #}

{# ── Article JSON-LD ── #}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "{{ title }}",
  "description": "{{ description }}",
  "datePublished": "{{ date }}",
  {% if updated %}"dateModified": "{{ updated }}",{% endif %}
  "author": {
    "@type": "Person",
    "name": "{{ author or 'Car Alpha Editorial' }}"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Car Alpha",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.caralpha.com/assets/images/logo.png"
    }
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ 'https://www.caralpha.com' + page.url }}"
  }{% if ogImage %},
  "image": "{{ ogImage }}"{% endif %}
}
</script>

<div class="max-w-6xl mx-auto px-4 py-10 md:py-16">

  {# ── Breadcrumbs ── #}
  {% if breadcrumbs and breadcrumbs.length %}
    {% include "partials/breadcrumbs.njk" %}
  {% endif %}

  {# ── Guide Header ── #}
  <header class="mb-10 max-w-3xl">
    {% if category %}
    <div class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full border border-volt-500/15 bg-volt-500/[0.04] text-xs font-semibold text-volt-400 mb-5 uppercase tracking-widest">{{ category }}</div>
    {% endif %}

    <h1 class="text-3xl md:text-4xl lg:text-5xl font-black text-white tracking-tight leading-tight">{{ title }}</h1>

    {% if description %}
    <p class="mt-4 text-lg text-silver-400 leading-relaxed">{{ description }}</p>
    {% endif %}

    {# ── Author & Date Meta ── #}
    <div class="mt-6 flex flex-wrap items-center gap-4 text-sm text-silver-500">
      {% if author %}
      <div class="flex items-center gap-2">
        <div class="w-8 h-8 rounded-full bg-gradient-to-br from-volt-500 to-volt-700 grid place-items-center text-white text-xs font-bold">{{ author | truncate(1, true, "") | upper }}</div>
        <span class="font-medium text-silver-300">{{ author }}</span>
      </div>
      {% endif %}
      {% if date %}
      <div class="flex items-center gap-1.5">
        <svg class="w-4 h-4 text-silver-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5"/></svg>
        <time datetime="{{ date }}">{{ date | dateFormat("LLLL d, yyyy") }}</time>
      </div>
      {% endif %}
      {% if updated %}
      <div class="flex items-center gap-1.5">
        <svg class="w-4 h-4 text-silver-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182"/></svg>
        <span>Updated {{ updated | dateFormat("LLLL d, yyyy") }}</span>
      </div>
      {% endif %}
      {% if readingTime %}
      <div class="flex items-center gap-1.5">
        <svg class="w-4 h-4 text-silver-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
        <span>{{ readingTime }} min read</span>
      </div>
      {% endif %}
    </div>
  </header>

  <div class="divider mb-10"></div>

  {# ── Content + Sidebar ── #}
  <div class="flex flex-col lg:flex-row gap-10">

    {# ── Main Content Area ── #}
    <div class="flex-1 min-w-0">

      {# ── Table of Contents (auto-generated from headings) ── #}
      {% if toc and toc.length %}
      <nav class="glass-card metallic-border rounded-2xl p-6 mb-10 carbon-panel" aria-label="Table of Contents">
        <h2 class="text-sm font-bold text-white uppercase tracking-widest mb-4 flex items-center gap-2">
          <svg class="w-4 h-4 text-volt-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zM3.75 12h.007v.008H3.75V12zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm-.375 5.25h.007v.008H3.75v-.008zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"/></svg>
          In This Guide
        </h2>
        <ol class="space-y-2">
          {% for item in toc %}
          <li>
            <a href="#{{ item.id }}" class="flex items-center gap-2 text-sm text-silver-400 hover:text-volt-400 transition-colors py-1">
              <span class="w-5 h-5 rounded-md bg-volt-500/10 border border-volt-500/15 grid place-items-center text-[10px] font-bold text-volt-400 shrink-0">{{ loop.index }}</span>
              {{ item.text }}
            </a>
          </li>
          {% endfor %}
        </ol>
      </nav>
      {% endif %}

      {# ── Guide Content ── #}
      <div class="prose-dark">
        {{ content | safe }}
      </div>

      {# ── Bottom CTA ── #}
      <div class="mt-12 glass-card metallic-border rounded-2xl p-8 carbon-panel text-center">
        <h3 class="text-xl font-bold text-white mb-3">Need Personalized Guidance?</h3>
        <p class="text-silver-400 mb-6 max-w-lg mx-auto">Ask Car Alpha AI about your specific vehicle. Get tailored advice on insurance, warranty, repairs, and more.</p>
        <button onclick="document.getElementById('aiOverlay').classList.add('active')" class="inline-flex items-center gap-2 px-6 py-3 rounded-xl btn-primary text-white font-bold text-sm">
          <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.455 2.456L21.75 6l-1.036.259a3.375 3.375 0 00-2.455 2.456z"/></svg>
          Ask Car Alpha AI
        </button>
      </div>
    </div>

    {# ── Sidebar ── #}
    <aside class="w-full lg:w-80 shrink-0 space-y-6">

      {# ── Related Guides ── #}
      {% if relatedGuides and relatedGuides.length %}
      <div class="glass-card metallic-border rounded-2xl overflow-hidden carbon-panel">
        <div class="steel-header px-5 py-3.5">
          <h3 class="text-sm font-bold text-white uppercase tracking-wider">Related Guides</h3>
        </div>
        <div class="p-4 space-y-2">
          {% for guide in relatedGuides | limit(5) %}
          <a href="{{ guide.url }}" class="flex items-start gap-3 p-3 rounded-xl hover:bg-white/[0.03] transition-colors group">
            <svg class="w-4 h-4 text-volt-500 mt-0.5 shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"/></svg>
            <div>
              <div class="text-sm font-medium text-silver-300 group-hover:text-volt-400 transition-colors leading-snug">{{ guide.title }}</div>
              {% if guide.description %}
              <div class="text-xs text-silver-500 mt-1 line-clamp-2">{{ guide.description }}</div>
              {% endif %}
            </div>
          </a>
          {% endfor %}
        </div>
      </div>
      {% endif %}

      {# ── Monetization CTAs ── #}
      {% include "partials/monetization.njk" %}
    </aside>

  </div>
</div>
